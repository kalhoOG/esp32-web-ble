<!DOCTYPE html>
<html>
<head>
    <title>ESP32 Golf Swing Monitor</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
    <h1>ESP32 Golf Swing Monitor</h1>

    <!-- BLE Connection -->
    <button id="connectButton">Connect to BLE Device</button>
    <button id="disconnectButton">Disconnect</button>
    <p>Status: <strong><span id="bleStatus" style="color: red;">Disconnected</span></strong></p>

    <!-- Display Club Head Speed Data -->
    <h2>Current Club Head Speed</h2>
    <p><strong>Speed:</strong> <span id="currentSpeed">0</span> m/s</p>

    <h2>Maximum Club Head Speed</h2>
    <p><strong>Max Speed:</strong> <span id="maxSpeed">0</span> m/s</p>

    <h2>Last 5 Club Head Speeds</h2>
    <ul id="lastFiveSpeeds">
        <li>0 m/s</li>
        <li>0 m/s</li>
        <li>0 m/s</li>
        <li>0 m/s</li>
        <li>0 m/s</li>
    </ul>

    <script>
        // BLE Characteristic UUIDs (Ensure these match the C++ code)
        const SERVICE_UUID = "19b10000-e8f2-537e-4f6c-d104768a1214";
        const CLUB_SPEED_UUID = "19b10004-e8f2-537e-4f6c-d104768a1214";
        const MAX_SPEED_UUID = "19b10005-e8f2-537e-4f6c-d104768a1214";
        const LAST_FIVE_UUID = "19b10006-e8f2-537e-4f6c-d104768a1214";

        let device;
        let bleServer;
        let clubSpeedCharacteristic;
        let maxSpeedCharacteristic;
        let lastFiveCharacteristic;

        const bleStatus = document.getElementById("bleStatus");
        const currentSpeed = document.getElementById("currentSpeed");
        const maxSpeed = document.getElementById("maxSpeed");
        const lastFiveSpeeds = document.getElementById("lastFiveSpeeds");

        document.getElementById("connectButton").addEventListener("click", connectToDevice);
        document.getElementById("disconnectButton").addEventListener("click", disconnectDevice);

        async function connectToDevice() {
            try {
                // Request device
                device = await navigator.bluetooth.requestDevice({
                    filters: [{ services: [SERVICE_UUID] }]
                });

                bleStatus.textContent = "Connecting...";
                bleStatus.style.color = "orange";

                // Connect and get services
                bleServer = await device.gatt.connect();
                const service = await bleServer.getPrimaryService(SERVICE_UUID);

                // Get characteristics
                clubSpeedCharacteristic = await service.getCharacteristic(CLUB_SPEED_UUID);
                maxSpeedCharacteristic = await service.getCharacteristic(MAX_SPEED_UUID);
                lastFiveCharacteristic = await service.getCharacteristic(LAST_FIVE_UUID);

                // Start notifications
                clubSpeedCharacteristic.addEventListener("characteristicvaluechanged", handleClubSpeed);
                await clubSpeedCharacteristic.startNotifications();

                maxSpeedCharacteristic.addEventListener("characteristicvaluechanged", handleMaxSpeed);
                await maxSpeedCharacteristic.startNotifications();

                lastFiveCharacteristic.addEventListener("characteristicvaluechanged", handleLastFive);
                await lastFiveCharacteristic.startNotifications();

                bleStatus.textContent = "Connected";
                bleStatus.style.color = "green";

            } catch (error) {
                console.error(error);
                bleStatus.textContent = "Connection Failed";
                bleStatus.style.color = "red";
            }
        }

        function disconnectDevice() {
            if (device && device.gatt.connected) {
                device.gatt.disconnect();
                bleStatus.textContent = "Disconnected";
                bleStatus.style.color = "red";
            }
        }

        // Update Current Club Head Speed
        function handleClubSpeed(event) {
            const speed = event.target.value.getFloat32(0, true); // Assuming 4-byte float
            currentSpeed.textContent = speed.toFixed(2);
        }

        // Update Maximum Club Head Speed
        function handleMaxSpeed(event) {
            const max = event.target.value.getFloat32(0, true);
            maxSpeed.textConte
